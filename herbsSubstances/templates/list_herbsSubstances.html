{% load static %}
{% load custom_filters %}
<!DOCTYPE html>
<html>

<head>
    <title>Listagem de Ervas | Substâncias</title>
    <link rel="stylesheet" href="{% static 'herbs/styles.css' %}">
</head>

<body>
    <div class="container">
        <div class="nav">
            <br>
            <h1>Herbs Substances</h1>
        </div>
        <a href="{% url 'add-herbsSubstances' %}" class="floating-button">+</a>
        <section class="table__body" style="scale: 0.8;">
            <table>
                <thead>
                    <tr>
                        <th>Id <span class="icon-arrow">&UpArrow;</span></th>
                        <th>Name <span class="icon-arrow">&uparrow;</span></th>
                        <th>Breve resumo <span class="icon-arrow">&UpArrow;</span></th>
                        <th>O que é? <span class="icon-arrow">&UpArrow;</span></th>
                        <th>Principais Benefícios <span class="icon-arrow">&UpArrow;</span></th>
                        <th>potencialmente boa para o que? <span class="icon-arrow">&UpArrow;</span></th>
                        <th>Doenças relacionadas <span class="icon-arrow">&UpArrow;</span></th>
                        <th>Desvantagens/cuidados <span class="icon-arrow">&UpArrow;</span></th>
                        <th>Como funciona? <span class="icon-arrow">&UpArrow;</span></th>
                        <th>Dosagem, informações <span class="icon-arrow">&UpArrow;</span></th>
                        <th>FAQ</th>
                        <th>studos Científicos</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    {% for item in herbsSubstances_items %}
                    <tr>
                        <td>{{ item.id }}</td>
                        <td>{{ item.name }}</td>
                        <td>{{ item.resumo|truncatechars:50 }}</td>
                        <td>{{ item.oque_e|truncatechars:50 }}</td>
                        <td>{{ item.beneficios|truncatechars:50 }}</td>
                        <td>{{ item.boa_para_que|truncatechars:50 }}</td>
                        <td>{{ item.doencas_relacionada|truncatechars:50 }}</td>
                        <td>{{ item.como_funciona|truncatechars:50 }}</td>
                        <td>{{ item.desvantagens_cuidados|truncatechars:50 }}</td>
                        <td>{{ item.dosagem|truncatechars:50 }}</td>
                        <td>{{ item.faq|truncatechars:50 }}</td>
                        <td>{{ item.estudos|truncatechars:50 }}</td>
                        <td>
                            <button class="btn btn-primary modal-btn" data-modal-target="#modal-{{ item.id }}"><i
                                    class="bi bi-eye"></i> Detalhes</button>
                            <a href="{% url 'editar-herbsSubstances' item.id %}" class="btn btn-primary"><i
                                    class="bi bi-pencil"></i>
                                Editar</a>
                            <button class="btn btn-danger btn-excluir" data-toggle="modal" data-target="#modal-excluir"
                                data-item-id="{{ item.id }}">
                                <i class="bi bi-trash"></i> Excluir
                            </button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </section>
        <!-- Paginação -->
        <div class="pagination">
            <span class="step-links">
                {% if saude_items.has_previous %}
                <a href="?page=1">&laquo; Primeira página</a>
                <a href="?page={{ herbsSubstances_items.previous_page_number }}">voltar</a>
                {% endif %}

                <span class="current">
                    Página {{ herbsSubstances_items.number }} de {{ herbsSubstances_items.paginator.num_pages }}.
                </span>

                {% if saude_items.has_next %}
                <a href="?page={{ herbsSubstances_items.next_page_number }}">Próxima</a>
                <a href="?page={{ herbsSubstances_items.paginator.num_pages }}">Ultima &raquo;</a>
                {% endif %}
            </span>
        </div>
    </div>

    <!-- Modal -->
    {% for item in herbsSubstances_items %}
    <div class="modal" id="modal-{{ item.id }}">
        <div class="modal-content">
            <!-- Conteúdo detalhado do item -->
            <h2>{{ item.name }}</h2><br>
            <p><b>Breve resumo:</b><br>{{ item.resumo }}</p><br>
            <p><b>O que é?</b><br>{{ item.oque_e }}</p><br>
            <p><b>Principais Benefícios:</b><br>{{ item.beneficios }}</p><br>
            <p><b>Potencialmente boa para o que?</b><br>{{ item.boa_para_que }}</p><br>
            <p><b>Doenças relacionadas:</b><br>{{ item.doencas_relacionada }}</p><br>
            <p><b>Desvantagens/cuidados:</b><br>{{ item.desvantagens_cuidados }}</p><br>
            <p><b>Como funciona?</b><br>{{ item.como_funciona }}</p><br>
            <p><b>Dosagem, informações:</b><br>{{ item.dosagem }}</p><br>
            <p><b>FAQ:</b><br>{{ item.faq }}</p><br>
            <p><b>Estudos Científicos:</b><br>{{ item.estudos }}</p><br>
        </div>
    </div>
    <div class="modal" id="modal-excluir">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <center>
                        <h5 class="modal-title">Confirmação de Exclusão</h5>
                    </center>
                </div>

                <div class="modal-body">
                    <p>Você tem certeza que deseja excluir este item?{{item.id}}</p>
                </div>
                <div class="modal-footer">
                    <!-- Botão para cancelar a exclusão -->
                    <button type="button" class="btn btn-secondary" data-dismiss="modal">Cancelar</button>
                    <!-- Formulário para submeter a exclusão -->
                    <form id="form-excluir" method="GET" action="{% url 'excluir-herbsSubstances' item.id  %}">
                        {% csrf_token %}
                        <input type="hidden" id="item_id_input" name="item_id" value="">
                        <button type="submit" class="btn btn-primary btn-confirmar">Sim</button>
                    </form>

                </div>

            </div>
        </div>
    </div>
    {% endfor %}



    <!-- Resto do HTML... -->

    <!-- No final do seu HTML, adicione o seguinte script -->
    <script>
        $(document).ready(function () {
            var modal = $('#modal-excluir');
            var btnExcluir = $('.btn-excluir');
            var btnConfirmar = $('.btn-confirmar');
    
            // Ação quando o usuário clicar em um dos botões de exclusão
            btnExcluir.on('click', function (event) {
                event.preventDefault(); // Impede o comportamento padrão de clicar no botão
                var itemId = $(this).closest('tr').find('.item-id').text();
                modal.find('#item_id_input').val(itemId);
                modal.modal('show');
            });
    
            // Ação quando o usuário clicar no botão "Sim" no modal de confirmação
            btnConfirmar.click(function () {
                // Submeta o formulário para a exclusão
                $('#form-excluir').submit();
            });
    
            // Ação quando o modal for ocultado
            modal.on('hidden.bs.modal', function () {
                // Atualize a página após um pequeno atraso
                setTimeout(function () {
                    location.reload();
                }, 100);
            });
        });
    </script>
    

  






</body>

</html>